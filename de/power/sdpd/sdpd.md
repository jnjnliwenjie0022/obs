# internal_power_cell

```verilog
cell (AN2D1BWP30P140) {
  area : 0.504;
  cell_footprint : "an2d1";
  pin(A1) {
    driver_waveform_fall : "tcbn28hpcplusbwp30p140ssg0p81vm40c:fall";
    driver_waveform_rise : "tcbn28hpcplusbwp30p140ssg0p81vm40c:rise";
    direction : input;
    related_ground_pin : VSS;
    related_power_pin : VDD;
    capacitance : 0.000363402;
    rise_capacitance : 0.000363402;
    fall_capacitance : 0.000339814;
    internal_power () {
      when : "!A2&!Z";
      related_pg_pin : VDD;
      rise_power (passive_power_template_7x1) {
        index_1 ("0.0024, 0.0104, 0.0265, 0.0588, 0.1232, 0.252, 0.5098");
        values ( \
          "-0.000150435, -0.000148767, -0.000150144, -0.000150693, -0.000150951, -0.000151131, -0.000151014" \
        );
      }
      fall_power (passive_power_template_7x1) {
        index_1 ("0.0024, 0.0104, 0.0265, 0.0588, 0.1232, 0.252, 0.5098");
        values ( \
          "0.000151273, 0.000150181, 0.000151189, 0.000151602, 0.000151753, 0.000151727, 0.000151233" \
        );
      }
    }
  }
  pin(A2) {
    driver_waveform_fall : "tcbn28hpcplusbwp30p140ssg0p81vm40c:fall";
    driver_waveform_rise : "tcbn28hpcplusbwp30p140ssg0p81vm40c:rise";
    direction : input;
    related_ground_pin : VSS;
    related_power_pin : VDD;
    capacitance : 0.000403461;
    rise_capacitance : 0.00039686;
    fall_capacitance : 0.000403461;
    internal_power () {
      when : "!A1&!Z";
      related_pg_pin : VDD;
      rise_power (passive_power_template_7x1) {
        index_1 ("0.0024, 0.0104, 0.0265, 0.0588, 0.1232, 0.252, 0.5098");
        values ( \
          "-0.000124494, -0.000122856, -0.000124154, -0.000124829, -0.000124855, -0.000125097, -0.000124324" \
        );
      }
      fall_power (passive_power_template_7x1) {
        index_1 ("0.0024, 0.0104, 0.0265, 0.0588, 0.1232, 0.252, 0.5098");
        values ( \
          "0.000131068, 0.000125402, 0.00012539, 0.000125277, 0.000125325, 0.000125339, 0.000124708" \
        );
      }
    }
  }
  pin(Z) {
    direction : output;
    power_down_function : "!VDD + VSS";
    function : "(A1 A2)";
    related_ground_pin : VSS;
    related_power_pin : VDD;
    max_capacitance : 0.0904141;
    min_capacitance : 0.00022;
    internal_power () {
      related_pin : "A1";
      related_pg_pin : VDD;
      rise_power (power_template_7x7) {
        index_1 ("0.0024, 0.0104, 0.0265, 0.0588, 0.1232, 0.252, 0.5098");
        index_2 ("0.00022, 0.0021, 0.00587, 0.01341, 0.02848, 0.05863, 0.11893");
        values ( \
          "0.000492491, 0.000516003, 0.000525992, 0.000524145, 0.000537672, 0.000546089, 0.000529228", \
          "0.00048588, 0.000507796, 0.000523972, 0.000529062, 0.000532213, 0.000524761, 0.000537612", \
          "0.000473126, 0.000492424, 0.000502575, 0.000518815, 0.000533104, 0.000524624, 0.000528888", \
          "0.000462186, 0.000479055, 0.000493537, 0.000507548, 0.000511784, 0.000508278, 0.000530038", \
          "0.00045403, 0.000471965, 0.000484601, 0.000491875, 0.000500323, 0.000496816, 0.000515904", \
          "0.000452918, 0.00046691, 0.000480973, 0.000485872, 0.000488691, 0.000491576, 0.00050569", \
          "0.000467348, 0.00047223, 0.000489519, 0.000504997, 0.000517268, 0.000513494, 0.000528394" \
        );
      }
      fall_power (power_template_7x7) {
        index_1 ("0.0024, 0.0104, 0.0265, 0.0588, 0.1232, 0.252, 0.5098");
        index_2 ("0.00022, 0.0021, 0.00587, 0.01341, 0.02848, 0.05863, 0.11893");
        values ( \
          "0.000834045, 0.000855262, 0.000862586, 0.000864234, 0.000864379, 0.00086488, 0.000864596", \
          "0.000817909, 0.000839425, 0.000848647, 0.000851844, 0.000852256, 0.000852143, 0.000851831", \
          "0.000800464, 0.000818345, 0.000829965, 0.000835601, 0.000837492, 0.000837966, 0.000837997", \
          "0.000783007, 0.000798411, 0.000810429, 0.000819259, 0.000823727, 0.000825501, 0.000826285", \
          "0.000775183, 0.000788493, 0.000799789, 0.000809619, 0.000815809, 0.000819565, 0.000820632", \
          "0.00077789, 0.000787667, 0.000798054, 0.000808397, 0.00081704, 0.000822619, 0.000825848", \
          "0.000803765, 0.00080956, 0.00081806, 0.000826972, 0.000836407, 0.000843709, 0.000849202" \
        );
      }
    }
    internal_power () {
      related_pin : "A2";
      related_pg_pin : VDD;
      rise_power (power_template_7x7) {
        index_1 ("0.0024, 0.0104, 0.0265, 0.0588, 0.1232, 0.252, 0.5098");
        index_2 ("0.00022, 0.0021, 0.00587, 0.01341, 0.02848, 0.05863, 0.11893");
        values ( \
          "0.000485097, 0.0005094, 0.000516834, 0.00051402, 0.000527053, 0.000526511, 0.000527357", \
          "0.000482011, 0.000505563, 0.000519958, 0.000514587, 0.000518191, 0.000524129, 0.000528596", \
          "0.000473247, 0.000493643, 0.000508283, 0.000514878, 0.000528648, 0.000525207, 0.000522635", \
          "0.000462388, 0.000483913, 0.000498221, 0.000509662, 0.000512327, 0.000528884, 0.000509367", \
          "0.000456421, 0.000475317, 0.000490415, 0.000496653, 0.000505507, 0.000512336, 0.000516009", \
          "0.000450698, 0.000465216, 0.000476451, 0.000492125, 0.000506511, 0.000509744, 0.000512113", \
          "0.000450659, 0.000462074, 0.000471034, 0.000484479, 0.000501327, 0.00050912, 0.000507925" \
        );
      }
      fall_power (power_template_7x7) {
        index_1 ("0.0024, 0.0104, 0.0265, 0.0588, 0.1232, 0.252, 0.5098");
        index_2 ("0.00022, 0.0021, 0.00587, 0.01341, 0.02848, 0.05863, 0.11893");
        values ( \
          "0.00092141, 0.000935526, 0.000939565, 0.000940542, 0.000940556, 0.00094052, 0.000940351", \
          "0.000908553, 0.000924185, 0.00093005, 0.000931786, 0.000931794, 0.000931559, 0.000931384", \
          "0.000895602, 0.0009096, 0.000917798, 0.000921339, 0.000922132, 0.00092237, 0.000922219", \
          "0.000881968, 0.000895109, 0.000904028, 0.000910631, 0.000913364, 0.000914561, 0.000914926", \
          "0.000874206, 0.000885474, 0.000894809, 0.000902671, 0.000907327, 0.000909799, 0.000910889", \
          "0.000874975, 0.000884343, 0.000893079, 0.000901503, 0.000907978, 0.000912101, 0.000914238", \
          "0.000893877, 0.000899679, 0.0009069, 0.000914421, 0.000921503, 0.000926922, 0.000930472" \
        );
      }
    }
}
```

- 用direction區分成: input/output
	- input: 不會有related_pin
	- output: 一定有related_pin
- 不論是input/output: rise_power/fall_power是根據pin而言，而不是related_pin
- index_1：input transition
- index_2：output transition

# internal_power_reg

| case | related_pin(D) | pin(CLK) | Table (depend on CLK) | value (depend on D) |
| ---- | -------------- | -------- | --------------------- | ------------------- |
| #1   | 0->1           | 0->1     | rise_power            | data_toggle         |
| #2   | 0->1           | 1->0     | fall_power            | data_toggle         |
| #3   | 1->0           | 0->1     | rise_power            | data_toggle         |
| #4   | 1->0           | 1->0     | fall_power            | data_toggle         |
| #5   | none           | 0->0     | No Internal Power     | No Internal Power   |
| #6   | none           | 1->1     | No Internal Power     | No Internal Power   |
| #7   | 0->0           | 0->1     | rise_power            | no_data_toggle      |
| #8   | 0->0           | 1->0     | fall_power            | no_data_toggle      |
| #9   | 1->1           | 0->1     | rise_power            | no_data_toggle      |
| #10  | 1->1           | 1->0     | fall_power            | no_data_toggle      |
- Q與internal power完全無關，Q只有switch power有關
- CLK只要有變動就有internal power
# switch_power

| case | pin(X) | Table           |
| ---- | ------ | --------------- |
| #1   | 0->1   | rise_power      |
| #2   | 1->0   | fall_power      |
| #3   | 0->0   | no_switch_power |
| #4   | 1->1   | no_switch_power |
E = C * VDD^2

# leakage_power
| when(A,B,C,...,etc) | Table         |
| ------------------- | ------------- |
| 1                   | leakage_power |
